sap.ui.define([                                                                                                                                                                                                                                                
    "sap/ui/core/mvc/Controller",                                                                                                                                                                                                                              
    "com/vistex/zagriplan/model/models",                                                                                                                                                                                                                       
    "sap/ui/model/json/JSONModel",                                                                                                                                                                                                                             
    "sap/ui/Device",                                                                                                                                                                                                                                           
    "sap/ui/core/routing/History",                                                                                                                                                                                                                             
    "sap/m/MessageBox",                                                                                                                                                                                                                                        
    'sap/m/ColumnListItem',                                                                                                                                                                                                                                    
    'sap/m/Label',                                                                                                                                                                                                                                             
    'sap/m/Token',                                                                                                                                                                                                                                             
    'sap/m/MessageToast',                                                                                                                                                                                                                                      
    'sap/ui/export/Spreadsheet'                                                                                                                                                                                                                                
], function(Controller, models, JSONModel, Device, History, MessageBox, ColumnListItem, Label, Token, MessageToast, Spreadsheet) {                                                                                                                             
    "use strict";                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
    return Controller.extend("com.vistex.zagriplan.controller.Orcamento", {                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
        /**                                                                                                                                                                                                                                                    
         * Called when a controller is instantiated and its View controls (if available) are already created.                                                                                                                                                  
         * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.                                                                                                                                 
         * @memberOf com.vistex.zagriplan.WebContent.view.Orcamento - Sequeira                                                                                                                                                                                 
         */                                                                                                                                                                                                                                                    
        addDays: function(date, days) {                                                                                                                                                                                                                        
            var result = new Date(date);                                                                                                                                                                                                                       
            result.setDate(result.getDate() + days);                                                                                                                                                                                                           
            return result;                                                                                                                                                                                                                                     
        },                                                                                                                                                                                                                                                     
        checkSplitMode: function() {                                                                                                                                                                                                                           
            debugger                                                                                                                                                                                                                                           
            if (this.oView.getParent().getParent().getMode() === sap.m.SplitAppMode.HideMode) {                                                                                                                                                                
                this.oView.byId("idFull").setVisible(false);                                                                                                                                                                                                   
                this.oView.byId("idExit").setVisible(true);                                                                                                                                                                                                    
            } else if (this.oView.getParent().getParent().getMode() === sap.m.SplitAppMode.ShowHideMode) {                                                                                                                                                     
                this.oView.byId("idFull").setVisible(true);                                                                                                                                                                                                    
                this.oView.byId("idExit").setVisible(false);                                                                                                                                                                                                   
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        onFullScreen: function(oEvent) {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
            switch (oEvent.getSource().sId.split('-')[2]) {                                                                                                                                                                                                    
                case "idFull":                                                                                                                                                                                                                                 
                    this.getView().getParent().getParent().setMode(sap.m.SplitAppMode.HideMode);                                                                                                                                                               
                    this.oView.byId("idFull").setVisible(false);                                                                                                                                                                                               
                    this.oView.byId("idExit").setVisible(true);                                                                                                                                                                                                
                    break;                                                                                                                                                                                                                                     
                case "idExit":                                                                                                                                                                                                                                 
                    this.getView().getParent().getParent().setMode(sap.m.SplitAppMode.ShowHideMode);                                                                                                                                                           
                    this.oView.byId("idExit").setVisible(false);                                                                                                                                                                                               
                    this.oView.byId("idFull").setVisible(true);                                                                                                                                                                                                
                    break;                                                                                                                                                                                                                                     
                default:                                                                                                                                                                                                                                       
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
      //Sequeira                                                                                                                                                                                                                                               
        onchangeView1: function(oEvent) {                                                                                                                                                                                                                      
        	//Disable/Enable some columns...                                                                                                                                                                                                                      
        	var oTable = this.getView().byId("idTabProdutos");                                                                                                                                                                                                    
            oTable.getColumns()[6].setVisible(this.simpleview);                                                                                                                                                                                                
            oTable.getColumns()[7].setVisible(this.simpleview);                                                                                                                                                                                                
            oTable.getColumns()[8].setVisible(this.simpleview);                                                                                                                                                                                                
            oTable.getColumns()[9].setVisible(this.simpleview);&nbsp;&nbsp;                                                                                                                                                                                    
            oTable.getColumns()[10].setVisible(this.simpleview);                                                                                                                                                                                               
            oTable.getColumns()[11].setVisible(this.simpleview);&nbsp;                                                                                                                                                                                         
            oTable.getColumns()[12].setVisible(this.simpleview);                                                                                                                                                                                               
            oTable.getColumns()[13].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                 
//            oTable.getColumns()[16].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[17].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[18].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[19].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[20].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[21].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[22].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[23].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                             
//            oTable.getColumns()[24].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[25].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[26].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[27].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[28].setVisible(this.simpleview);                                                                                                                                                                                             
//            oTable.getColumns()[29].setVisible(this.simpleview);&nbsp;&nbsp;                                                                                                                                                                                 
        	this.simpleview = !this.simpleview;                                                                                                                                                                                                                   
        	//Show or not the "Limpar" field...                                                                                                                                                                                                                   
        	if (this.simpleview){                                                                                                                                                                                                                                 
        		this.getView().byId("meclean1").setVisible(true);                                                                                                                                                                                                    
        	} else {                                                                                                                                                                                                                                              
        		this.getView().byId("meclean1").setVisible(false);                                                                                                                                                                                                   
        	}        	                                                                                                                                                                                                                                            
        },                                                                                                                                                                                                                                                     
        onchangeView2: function(oEvent) {                                                                                                                                                                                                                      
        	//Disable/Enable some columns...                                                                                                                                                                                                                      
        	var oTable = this.getView().byId("idTableQtdeProdutos");                                                                                                                                                                                              
            oTable.getColumns()[6].setVisible(this.simpleview);                                                                                                                                                                                                
            oTable.getColumns()[7].setVisible(this.simpleview);                                                                                                                                                                                                
            oTable.getColumns()[8].setVisible(this.simpleview);                                                                                                                                                                                                
            oTable.getColumns()[9].setVisible(this.simpleview);                                                                                                                                                                                                
//            oTable.getColumns()[11].setVisible(this.simpleview);&nbsp;                                                                                                                                                                                       
//            oTable.getColumns()[12].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[13].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[14].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[15].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[16].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
//            oTable.getColumns()[17].setVisible(this.simpleview);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
        	this.simpleview = !this.simpleview;                                                                                                                                                                                                                   
        	//Show or not the "Limpar" field...                                                                                                                                                                                                                   
        	if (this.simpleview){                                                                                                                                                                                                                                 
        		this.getView().byId("meclean2").setVisible(true);                                                                                                                                                                                                    
        	} else {                                                                                                                                                                                                                                              
        		this.getView().byId("meclean2").setVisible(false);                                                                                                                                                                                                   
        	}         	        	                                                                                                                                                                                                                                  
        },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                     
        oneraseView1: function(oEvent) {                                                                                                                                                                                                                       
        	var that = this;&nbsp;                                                                                                                                                                                                                                
        	//Put zero on the Rows fields...                                                                                                                                                                                                                      
        	var oTable = this.getView().byId("idTabProdutos");                                                                                                                                                                                                    
        	var aIndex = oTable.getSelectedIndices();                                                                                                                                                                                                             
			aIndex.forEach(function (index, i) {                                                                                                                                                                                                                        
	            var sPath = oTable.getContextByIndex(index).getPath();                                                                                                                                                                                            
	            var res = sPath.split("/");                                                                                                                                                                                                                       
	            that.prdpath = parseInt(res[2]);&nbsp;                                                                                                                                                                                                            
//				oTable.getModel().setProperty(sPath + "/" + "M1D", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M1P", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M2D", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M2P", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M3D", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M3P", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M4D", "0.000");                                                                                                                                                                                             
//				oTable.getModel().setProperty(sPath + "/" + "M4P", "0.000");                                                                                                                                                                                             
				oTable.getModel().setProperty(sPath + "/" + "M5D", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M5P", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M6D", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M6P", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M7D", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M7P", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M8D", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M8P", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M9D", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M9P", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "M10D", "0.000");                                                                                                                                                                                              
				oTable.getModel().setProperty(sPath + "/" + "M10P", "0.000");                                                                                                                                                                                              
				oTable.getModel().setProperty(sPath + "/" + "M11D", "0.000");                                                                                                                                                                                              
				oTable.getModel().setProperty(sPath + "/" + "M11P", "0.000");                                                                                                                                                                                              
				oTable.getModel().setProperty(sPath + "/" + "M12D", "0.000");                                                                                                                                                                                              
				oTable.getModel().setProperty(sPath + "/" + "M12P", "0.000");				                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			oTable.getModel().refresh();                                                                                                                                                                                                                                
        	//Save the data...                                                                                                                                                                                                                                    
			this.onSave();                                                                                                                                                                                                                                              
        },&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                                             
        oneraseView2: function(oEvent) {                                                                                                                                                                                                                       
        	var that = this;&nbsp;                                                                                                                                                                                                                                
        	//Put zero on the Rows fields...                                                                                                                                                                                                                      
        	var oTable = this.getView().byId("idTableQtdeProdutos");                                                                                                                                                                                              
        	var aIndex = oTable.getSelectedIndices();                                                                                                                                                                                                             
			aIndex.forEach(function (index, i) {                                                                                                                                                                                                                        
	            var sPath = oTable.getContextByIndex(index).getPath();		                                                                                                                                                                                          
	            var res = sPath.split("/");                                                                                                                                                                                                                       
	            that.prdpath = parseInt(res[2]); 	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                        
//				oTable.getModel().setProperty(sPath + "/" + "P1", "0.000");                                                                                                                                                                                              
//				oTable.getModel().setProperty(sPath + "/" + "P2", "0.000");                                                                                                                                                                                              
//				oTable.getModel().setProperty(sPath + "/" + "P3", "0.000");                                                                                                                                                                                              
//				oTable.getModel().setProperty(sPath + "/" + "P4", "0.000");                                                                                                                                                                                              
				oTable.getModel().setProperty(sPath + "/" + "P5", "0.000");                                                                                                                                                                                                
				oTable.getModel().setProperty(sPath + "/" + "P6", "0.000");                                                                                                                                                                                                
				oTable.getModel().setProperty(sPath + "/" + "P7", "0.000");                                                                                                                                                                                                
				oTable.getModel().setProperty(sPath + "/" + "P8", "0.000");                                                                                                                                                                                                
				oTable.getModel().setProperty(sPath + "/" + "P9", "0.000");                                                                                                                                                                                                
				oTable.getModel().setProperty(sPath + "/" + "P10", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "P11", "0.000");                                                                                                                                                                                               
				oTable.getModel().setProperty(sPath + "/" + "P12", "0.000");                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
			oTable.getModel().refresh();                                                                                                                                                                                                                                
        	//Save the data...                                                                                                                                                                                                                                    
			this.onSaveProdutos();                                                                                                                                                                                                                                      
        },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                               
      //Sequeira                                                                                                                                                                                                                                               
        onChangeColor: function(oEvent) {                                                                                                                                                                                                                      
            debugger                                                                                                                                                                                                                                           
            var oPath = oEvent.getSource().getBindingContext().sPath;                                                                                                                                                                                          
            //Sequeira                                                                                                                                                                                                                                         
            var res = oPath.split("/");                                                                                                                                                                                                                        
            this.prdpath = parseInt(res[2]);&nbsp;                                                                                                                                                                                                             
            //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                 
            var oObject = oEvent.getSource().getBindingContext().getObject();                                                                                                                                                                                  
            var oField = oEvent.getSource().getBinding("value").sPath;                                                                                                                                                                                         
            var newValue = oEvent.getParameter("newValue");                                                                                                                                                                                                    
            var oTable = this.oView.byId("idTableResumo");                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            var a = newValue.replace(",", ".");                                                                                                                                                                                                                
            var x;                                                                                                                                                                                                                                             
            var y;                                                                                                                                                                                                                                             
            x = parseFloat(a).toFixed(2);                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
            //Sequeira                                                                                                                                                                                                                                         
            var res = oField.replace("D", "");                                                                                                                                                                                                                 
            var res = res.replace("P", "");                                                                                                                                                                                                                    
            res = "/" + res;                                                                                                                                                                                                                                   
            var boundObject = this.getView().getModel('modelYearMonth').getProperty(res);                                                                                                                                                                      
            this.myMonth = boundObject;                                                                                                                                                                                                                        
            var boundObject2 = this.getView().getModel('modelYearMonth').getProperty("/M1");                                                                                                                                                                   
            this.firstMonth = boundObject2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                            
            //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            this.oView.byId("idTabProdutos").getModel().setProperty(oPath + "/" + oField, x);                                                                                                                                                                  
            oEvent.getSource().addStyleClass("changeYellow");                                                                                                                                                                                                  
            this.onSave();                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        setVisible: function(value) {                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
            if (value === "X") {                                                                                                                                                                                                                               
                return "sap-icon://accept";                                                                                                                                                                                                                    
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        onExport: function() {                                                                                                                                                                                                                                 
            var aCols, aProducts, oSettings, oSheet;                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
            //			aCols = this.createColumnConfig();                                                                                                                                                                                                            
            aProducts = this.getView().getModel().getProperty('/');                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
            oSettings = {                                                                                                                                                                                                                                      
                workbook: {                                                                                                                                                                                                                                    
                    columns: aCols                                                                                                                                                                                                                             
                },                                                                                                                                                                                                                                             
                dataSource: aProducts                                                                                                                                                                                                                          
            };                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            oSheet = new Spreadsheet(oSettings);                                                                                                                                                                                                               
            oSheet.build()                                                                                                                                                                                                                                     
                .then(function() {                                                                                                                                                                                                                             
                    MessageToast.show('Arquivo exportado com sucesso');                                                                                                                                                                                        
                })                                                                                                                                                                                                                                             
                .finally(function() {                                                                                                                                                                                                                          
                    oSheet.destroy();                                                                                                                                                                                                                          
                });                                                                                                                                                                                                                                            
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onInit: function() {                                                                                                                                                                                                                                   
            this.oView.byId("c1").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c2").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c3").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c4").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c5").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c6").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c7").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c8").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c9").setHeaderSpan([2, 1]);                                                                                                                                                                                                       
            this.oView.byId("c10").setHeaderSpan([2, 1]);                                                                                                                                                                                                      
            this.oView.byId("c11").setHeaderSpan([2, 1]);                                                                                                                                                                                                      
            this.oView.byId("c12").setHeaderSpan([2, 1]);                                                                                                                                                                                                      
            this.getOwnerComponent().getRouter().getRoute("Orcamento").attachPatternMatched(this._onRouteMatched, this);                                                                                                                                       
            //Sequeira                                                                                                                                                                                                                                         
            this.prdpath;                                                                                                                                                                                                                                      
            this.simpleview = false;                                                                                                                                                                                                                           
            this.myMonth;                                                                                                                                                                                                                                      
            this.firstMonth;                                                                                                                                                                                                                                   
            //Remove default selected...                                                                                                                                                                                                                       
            //this.oView.byId("idReplicar").setSelected(true);                                                                                                                                                                                                 
            //Sequeira&nbsp;                                                                                                                                                                                                                                   
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        _onRouteMatched: function(oEvent) {                                                                                                                                                                                                                    
            // Set values                                                                                                                                                                                                                                      
            //			sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                             
        	                                                                                                                                                                                                                                                      
        	//Sequeira - Clear stuff...                                                                                                                                                                                                                           
        	try {                                                                                                                                                                                                                                                 
        	var oArgs = oEvent.getParameter("arguments");                                                                                                                                                                                                         
        	this.myversion = oArgs.Versao;                                                                                                                                                                                                                        
        	this.oView.byId("mysearch1").setValue('');                                                                                                                                                                                                            
        	this.oView.byId("mysearch2").setValue('');        	                                                                                                                                                                                                   
        	} catch (err) {                                                                                                                                                                                                                                       
        	  console.log(err);	                                                                                                                                                                                                                                  
        	}                                                                                                                                                                                                                                                     
        	//Sequeira                                                                                                                                                                                                                                            
        	                                                                                                                                                                                                                                                      
            this.checkSplitMode();                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
            var that = this;                                                                                                                                                                                                                                   
            this.oModel = models.callBackEnd();                                                                                                                                                                                                                
            debugger                                                                                                                                                                                                                                           
            this.oView.byId("idArea").setText(sap.ui.getCore().dadosMaster.Acdes);                                                                                                                                                                             
            this.oView.byId("idCentro").setText(sap.ui.getCore().dadosMaster.Werks);                                                                                                                                                                           
            this.oView.byId("idSafraIni").setText(sap.ui.getCore().dadosMaster.Datab.toISOString().substr(8, 2) + '.' +                                                                                                                                        
                sap.ui.getCore().dadosMaster.Datab.toISOString().substr(5, 2) + '.' +                                                                                                                                                                          
                sap.ui.getCore().dadosMaster.Datab.toISOString().substr(0, 4));                                                                                                                                                                                
            this.oView.byId("idSafraFim").setText(sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(8, 2) + '.' +                                                                                                                                        
                sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(5, 2) + '.' +                                                                                                                                                                          
                sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(0, 4));                                                                                                                                                                                
                                                                                                                                                                                                                                                               
            var date = this.addDays(sap.ui.getCore().dadosMaster.Datbi, 1);                                                                                                                                                                                    
            this.oView.byId("idSafraIniRef").setText(date.toISOString().substr(8, 2) + '.' +                                                                                                                                                                   
                date.toISOString().substr(5, 2) + '.' +                                                                                                                                                                                                        
                date.toISOString().substr(0, 4));                                                                                                                                                                                                              
            var lv_year = date.getUTCFullYear() + 1;                                                                                                                                                                                                           
            this.oView.byId("idSafraFimRef").setText(date.toLocaleDateString().replace("/", "/", "."));                                                                                                                                                        
            this.oView.byId("idOperacao").setText(sap.ui.getCore().dadosProcesso);                                                                                                                                                                             
            this.oView.byId("idTarefa").setText(sap.ui.getCore().dadosDetail.Wgbez);                                                                                                                                                                           
                                                                                                                                                                                                                                                               
            var json = new JSONModel();                                                                                                                                                                                                                        
            json.setData(sap.ui.getCore().modelYearMonth);                                                                                                                                                                                                     
            this.oView.setModel(json, "modelYearMonth");                                                                                                                                                                                                       
            this.getProdutos();                                                                                                                                                                                                                                
            //Sequeira - Getting the list of Material without the need on selecting the check...                                                                                                                                                               
            try {                                                                                                                                                                                                                                              
            this.onGetProdutos();                                                                                                                                                                                                                              
            }                                                                                                                                                                                                                                                  
            catch(err) {                                                                                                                                                                                                                                       
            }                                                                                                                                                                                                                                                  
        },                                                                                                                                                                                                                                                     
        sRcnum1: null,                                                                                                                                                                                                                                         
        sRcnum2: null,                                                                                                                                                                                                                                         
        sRcnum3: null,                                                                                                                                                                                                                                         
        sRcnum4: null,                                                                                                                                                                                                                                         
        sRcnum5: null,                                                                                                                                                                                                                                         
        sRcnum6: null,                                                                                                                                                                                                                                         
        sRcnum7: null,                                                                                                                                                                                                                                         
        sRcnum8: null,                                                                                                                                                                                                                                         
        sRcnum9: null,                                                                                                                                                                                                                                         
        sRcnum10: null,                                                                                                                                                                                                                                        
        MatnrG: null,                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
        getProdutos: function() {                                                                                                                                                                                                                              
            // CLEAR&nbsp;                                                                                                                                                                                                                                     
            for (var x = 0; x < this.oView.byId("idTabProdutos").getRows().length; x++) {                                                                                                                                                                      
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[2].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[4].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[6].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[8].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[10].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[12].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[14].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[16].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[18].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[20].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[22].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[24].removeStyleClass("changeYellow");                                                                                                                                                 
            }                                                                                                                                                                                                                                                  
            this.oView.byId("idTabProdutos").unbindRows();                                                                                                                                                                                                     
            this.oView.byId("idTableCusto").unbindRows();                                                                                                                                                                                                      
            //	this.oView.byId("idReceita").setValue("");                                                                                                                                                                                                      
            //	this.oView.byId("idRecDescr").setText("");                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
            var that = this;                                                                                                                                                                                                                                   
            this.oFilters = [];                                                                                                                                                                                                                                
            this.oFilters1 = [];                                                                                                                                                                                                                               
            this.oFilters2 = [];                                                                                                                                                                                                                               
            //Sequeira                                                                                                                                                                                                                                         
            var loFilters = [];                                                                                                                                                                                                                                
            //Sequeira                                                                                                                                                                                                                                         
            var date = that.addDays(sap.ui.getCore().dadosMaster.Datbi, 1);                                                                                                                                                                                    
            //	var lv_begda = date.toISOString().substr(0, 4) + date.toISOString().substr(5, 2) + date.toISOString().substr(8, 2);                                                                                                                             
            var lv_begda = sap.ui.getCore().dadosMaster.Datab.toISOString().substr(0, 4) + sap.ui.getCore().dadosMaster.Datab.toISOString().substr(                                                                                                            
                5, 2) + sap.ui.getCore().dadosMaster.Datab.toISOString().substr(8, 2);                                                                                                                                                                         
            var lv_year = date.getUTCFullYear() + 1;                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
            //	var lv_endda = lv_year + date.toLocaleDateString().substr(3, 2) + date.toLocaleDateString().substr(0, 2);                                                                                                                                       
            var lv_endda = sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(0, 4) + sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(                                                                                                            
                    5, 2) +                                                                                                                                                                                                                                    
                sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(8, 2);                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            this.lv_begda = lv_begda;                                                                                                                                                                                                                          
            this.lv_endda = lv_endda;                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
            this.oFilters.push(new sap.ui.model.Filter("Begda", "EQ", lv_begda));                                                                                                                                                                              
            this.oFilters.push(new sap.ui.model.Filter("Endda", "EQ", lv_endda));                                                                                                                                                                              
            this.oFilters.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                    
            this.oFilters.push(new sap.ui.model.Filter("Acnum", "EQ", sap.ui.getCore().dadosMaster.Acnum));                                                                                                                                                    
            this.oFilters.push(new sap.ui.model.Filter("Extwg", "EQ", sap.ui.getCore().dadosProcessoId));                                                                                                                                                      
            this.oFilters.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));                                                                                                                                                    
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            //Sequeira                                                                                                                                                                                                                                         
            this.oFilters.push(new sap.ui.model.Filter("Versao", "EQ", this.myversion));                                                                                                                                                                       
            loFilters.push(new sap.ui.model.Filter("Begda", "EQ", lv_begda));                                                                                                                                                                                  
            loFilters.push(new sap.ui.model.Filter("Endda", "EQ", lv_endda));                                                                                                                                                                                  
            loFilters.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                        
            loFilters.push(new sap.ui.model.Filter("Acnum", "EQ", sap.ui.getCore().dadosMaster.Acnum));                                                                                                                                                        
            loFilters.push(new sap.ui.model.Filter("Extwg", "EQ", sap.ui.getCore().dadosProcessoId));                                                                                                                                                          
            loFilters.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&+
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                              
            //Sequeira                                                                                                                                                                                                                                         
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            this.oFilters1.push(new sap.ui.model.Filter("Begda", "EQ", lv_begda));                                                                                                                                                                             
            this.oFilters1.push(new sap.ui.model.Filter("Endda", "EQ", lv_endda));                                                                                                                                                                             
            this.oFilters1.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                   
            this.oFilters1.push(new sap.ui.model.Filter("Acnum", "EQ", sap.ui.getCore().dadosMaster.Acnum));                                                                                                                                                   
            this.oFilters1.push(new sap.ui.model.Filter("Extwg", "EQ", sap.ui.getCore().dadosProcessoId));                                                                                                                                                     
            this.oFilters1.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));                                                                                                                                                   
            //	this.oFilters1.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                       
            this.oFilters2.push(new sap.ui.model.Filter("Begda", "EQ", lv_begda));                                                                                                                                                                             
            this.oFilters2.push(new sap.ui.model.Filter("Endda", "EQ", lv_endda));                                                                                                                                                                             
            this.oFilters2.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                   
            this.oFilters2.push(new sap.ui.model.Filter("Acnum", "EQ", sap.ui.getCore().dadosMaster.Acnum));                                                                                                                                                   
            this.oFilters2.push(new sap.ui.model.Filter("Extwg", "EQ", sap.ui.getCore().dadosProcessoId));                                                                                                                                                     
            this.oFilters2.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));                                                                                                                                                   
            this.oFilters2.push(new sap.ui.model.Filter("Matnr", "EQ", sap.ui.getCore().dadosDetail.Matnr));                                                                                                                                                   
            this.oModel.read("/GetResumoOrcSet", {                                                                                                                                                                                                             
                filters: this.oFilters,                                                                                                                                                                                                                        
                success: function(oData1) {                                                                                                                                                                                                                    
                    var json0 = new JSONModel();                                                                                                                                                                                                               
                    json0.setData({                                                                                                                                                                                                                            
                        modelResumo: oData1.results                                                                                                                                                                                                            
                    });                                                                                                                                                                                                                                        
                    that.oView.byId("idTableResumo").setModel(json0);                                                                                                                                                                                          
                    that.oView.byId("idTableResumo").bindRows("/modelResumo");                                                                                                                                                                                 
                    that.oView.byId("idTableResumo").setEnableBusyIndicator(false);                                                                                                                                                                            
                    //Sequeira                                                                                                                                                                                                                                 
                    that.oModel.read("/GetTalhaoIdadeSet", {                                                                                                                                                                                                   
                        filters: loFilters,//that.oFilters,                    //Sequeira                                                                                                                                                                      
                        success: function(oData3) {                                                                                                                                                                                                            
                            sap.ui.getCore().idadeTalhao = oData3.results;                                                                                                                                                                                     
                            sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                  
                        },                                                                                                                                                                                                                                     
                        error: function(oError) {                                                                                                                                                                                                              
                            //	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                        
                            sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                  
                        }                                                                                                                                                                                                                                      
                    });                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                    that.oModel.read("/CheckSavedRecipeSet", {                                                                                                                                                                                                 
                        filters: that.oFilters2,                                                                                                                                                                                                               
                        success: function(oData2) {                                                                                                                                                                                                            
                            //	console.log(oData2);                                                                                                                                                                                                            
                        	if(oData2.length > 0){                                                                                                                                                                                                                
                            that.sRcnum1 = oData2.results[0].Rcnum1;                                                                                                                                                                                           
                            that.sRcnum2 = oData2.results[0].Rcnum2;                                                                                                                                                                                           
                            that.sRcnum3 = oData2.results[0].Rcnum3;                                                                                                                                                                                           
                            that.sRcnum4 = oData2.results[0].Rcnum4;                                                                                                                                                                                           
                            that.sRcnum5 = oData2.results[0].Rcnum5;                                                                                                                                                                                           
                            that.sRcnum6 = oData2.results[0].Rcnum6;                                                                                                                                                                                           
                            that.sRcnum7 = oData2.results[0].Rcnum7;                                                                                                                                                                                           
                            that.sRcnum8 = oData2.results[0].Rcnum8;                                                                                                                                                                                           
                            that.sRcnum9 = oData2.results[0].Rcnum9;                                                                                                                                                                                           
                            that.sRcnum10 = oData2.results[0].Rcnum10;                                                                                                                                                                                         
                            //that.MatnrG = oData2.results[0].Matnr;                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                            //	var sRtext = oData2.results[0].Rctex;                                                                                                                                                                                           
                            /*var newModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                
                            	sap.ui.getCore().setModel(newModel, "ReceitF4");                                                                                                                                                                                  
                            sap.ui.getCore().getModel("ReceitF4").setData(oData3);*/                                                                                                                                                                           
                            //that.oView.byId("idReceita").setValue(sRcnum);                                                                                                                                                                                   
                            //that.oView.byId("idRecDescr").setText(sRtext);                                                                                                                                                                                   
                            var json = new JSONModel();                                                                                                                                                                                                        
                            json.setData({                                                                                                                                                                                                                     
                                modelProdutos: oData2.results                                                                                                                                                                                                  
                            });                                                                                                                                                                                                                                
                            that.oView.byId("idTabProdutos").setModel(json);                                                                                                                                                                                   
                            //	that.oView.byId("idTabProdutos").setVisibleRowCount(oData2.results.length);                                                                                                                                                     
                            that.oView.byId("idTabProdutos").bindRows("/modelProdutos");                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                            that.oView.byId("idTableQtdeProdutos").setModel(json);                                                                                                                                                                             
                            //that.oView.byId("idTableQtdeProdutos").setVisibleRowCount(oData2.results.length);                                                                                                                                                
                            that.oView.byId("idTableQtdeProdutos").bindRows("/modelProdutos");                                                                                                                                                                 
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum1", "EQ", that.sRcnum1));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum2", "EQ", that.sRcnum2));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum3", "EQ", that.sRcnum3));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum4", "EQ", that.sRcnum4));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum5", "EQ", that.sRcnum5));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum6", "EQ", that.sRcnum6));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum7", "EQ", that.sRcnum7));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum8", "EQ", that.sRcnum8));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum9", "EQ", that.sRcnum9));                                                                                                                                                        
                            that.oFilters1.push(new sap.ui.model.Filter("Rcnum10", "EQ", that.sRcnum10));                                                                                                                                                      
                            that.oFilters1.push(new sap.ui.model.Filter("Matnr", "EQ", sap.ui.getCore().dadosDetail.Matnr));                                                                                                                                   
                            //Sequeira                                                                                                                                                                                                                         
                            that.oFilters1.push(new sap.ui.model.Filter("Versao", "EQ", that.myversion));                                                                                                                                                      
                            //Sequeira                                                                                                                                                                                                                         
                            that.oModel.read("/CustoReceitaSet", {                                                                                                                                                                                             
                                filters: that.oFilters1,                                                                                                                                                                                                       
                                success: function(oData) {                                                                                                                                                                                                     
                                    /*	var newModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                       
						sap.ui.getCore().setModel(newModel, "CustoData");                                                                                                                                                                                                        
						sap.ui.getCore().getModel("CustoData").setData(oData2.results);                                                                                                                                                                                          
						var custoDataM = sap.ui.getCore().getModel("CustoData").getData();*/                                                                                                                                                                                     
                                    var json1 = new JSONModel();                                                                                                                                                                                               
                                    json1.setData({                                                                                                                                                                                                            
                                        modelCusto: oData.results                                                                                                                                                                                              
                                    });                                                                                                                                                                                                                        
                                    that.oView.byId("idTableCusto").setModel(json1);                                                                                                                                                                           
                                    that.oView.byId("idTableCusto").bindRows("/modelCusto");                                                                                                                                                                   
                                }                                                                                                                                                                                                                              
                            });                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                            sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                  
                        	}                                                                                                                                                                                                                                     
                        },                                                                                                                                                                                                                                     
                        error: function(oError) {                                                                                                                                                                                                              
                            sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                  
                        }                                                                                                                                                                                                                                      
                    });                                                                                                                                                                                                                                        
                }                                                                                                                                                                                                                                              
            });                                                                                                                                                                                                                                                
        },                                                                                                                                                                                                                                                     
        getCustoProdutoSet: function() {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        onChangeProdutos: function(oEvent) {                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
            debugger                                                                                                                                                                                                                                           
            var oPath = oEvent.getSource().getBindingContext().sPath;                                                                                                                                                                                          
            //Sequeira                                                                                                                                                                                                                                         
            var res = oPath.split("/");                                                                                                                                                                                                                        
            this.prdpath = parseInt(res[2]);&nbsp;                                                                                                                                                                                                             
            //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                           
            var oObject = oEvent.getSource().getBindingContext().getObject();                                                                                                                                                                                  
            var oField = oEvent.getSource().getBinding("value").sPath;                                                                                                                                                                                         
            var newValue = oEvent.getParameter("newValue");                                                                                                                                                                                                    
            var oTable = this.oView.byId("idTableResumo");                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            this.oFieldReplicar = oField;                                                                                                                                                                                                                      
            this.oReplicarObject = oObject;                                                                                                                                                                                                                    
            var a = newValue.replace(",", ".");                                                                                                                                                                                                                
            var x;                                                                                                                                                                                                                                             
            var y;                                                                                                                                                                                                                                             
            x = parseFloat(a).toFixed(2);                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
            this.oView.byId("idTableQtdeProdutos").getModel().setProperty(oPath + "/" + oField, x);                                                                                                                                                            
                                                                                                                                                                                                                                                               
            //Sequeira                                                                                                                                                                                                                                         
            var res = oField.replace("P", "M");                                                                                                                                                                                                                
            res = "/" + res;                                                                                                                                                                                                                                   
            var boundObject = this.getView().getModel('modelYearMonth').getProperty(res);                                                                                                                                                                      
            this.myMonth = boundObject;                                                                                                                                                                                                                        
            var boundObject2 = this.getView().getModel('modelYearMonth').getProperty("/M1");                                                                                                                                                                   
            this.firstMonth = boundObject2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                            
            //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            this.onSaveProdutos();                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        /**&nbsp;                                                                                                                                                                                                                                              
         * Filter/Search Table by Column. Common for all Tables.                                                                                                                                                                                               
         * @param {object} oEvent - Object of the source control.&nbsp;                                                                                                                                                                                        
         * @param {object} that - current view context                                                                                                                                                                                                         
         * @public                                                                                                                                                                                                                                             
         */                                                                                                                                                                                                                                                    
        onFilter: function(oEvent) {                                                                                                                                                                                                                           
            var that = this;                                                                                                                                                                                                                                   
            var tableId = this.getView().byId("idTabProdutos");                                                                                                                                                                                                
            var value = oEvent.getSource().getValue();                                                                                                                                                                                                         
            value = value.toString();                                                                                                                                                                                                                          
            var oTable = that.getView().byId(oEvent.getSource().data("table"));                                                                                                                                                                                
            var columns = oTable.getColumns();                                                                                                                                                                                                                 
            var len = columns.length;                                                                                                                                                                                                                          
            var oFilter = [];                                                                                                                                                                                                                                  
            var content = sap.ui.model.FilterOperator.Contains;                                                                                                                                                                                                
            var modelname = this.oView.byId("idTabProdutos").getModel();                                                                                                                                                                                       
            var path = oTable.getBindingInfo('rows').path;                                                                                                                                                                                                     
            var oModel = this.oView.byId("idTabProdutos").getModel();                                                                                                                                                                                          
            var modelQname = this.oView.byId("idTableQtdeProdutos").getModel();                                                                                                                                                                                
          /*  for (var i = 0; i < len; i++) {                                                                                                                                                                                                                  
                var columnname = columns[i].getFilterProperty();                                                                                                                                                                                               
                if (typeof oModel.getProperty("/modelProdutos/" + i + "/" + columnname) === "string") {                                                                                                                                                        
                    if (columnname !== "") {                                                                                                                                                                                                                   
                        oFilter.push(new sap.ui.model.Filter(columnname, content, value));                                                                                                                                                                     
                    }                                                                                                                                                                                                                                          
                }                                                                                                                                                                                                                                              
            }*/                                                                                                                                                                                                                                                
           var quantityPass = this.oView.byId("idQtdeProdutos");                                                                                                                                                                                               
           if(quantityPass.getSelected()){                                                                                                                                                                                                                     
            for (var k = 0; k < oTable.getModel().getData().modelProdutos.length; k++) {                                                                                                                                                                       
                var line = oTable.getModel().getData().modelProdutos[k];                                                                                                                                                                                       
                for (var i = 0; i < len; i++) {                                                                                                                                                                                                                
                    var columnname = columns[i].getFilterProperty();                                                                                                                                                                                           
                    if (typeof oModel.getProperty("/modelProdutos/" + k + "/" + columnname) === "string") {                                                                                                                                                    
                        if (columnname == "Rcnum1" || columnname == "Maktx" || columnname == "Tipo" || columnname == "Principal" || columnname == "MatnrIns")  {                                                                                               
                            oFilter.push(new sap.ui.model.Filter(columnname, content, value));                                                                                                                                                                 
                        }                                                                                                                                                                                                                                      
                    }                                                                                                                                                                                                                                          
                }&nbsp;                                                                                                                                                                                                                                        
            }                                                                                                                                                                                                                                                  
           } else {                                                                                                                                                                                                                                            
                for (var z = 0; z < oTable.getModel().getData().modelProdutos.length; z++) {                                                                                                                                                                   
                    var line = oTable.getModel().getData().modelProdutos[z];                                                                                                                                                                                   
                    for (var i = 0; i < len; i++) {                                                                                                                                                                                                            
                        var columnname = columns[i].getFilterProperty();                                                                                                                                                                                       
                        if (typeof oModel.getProperty("/modelProdutos/" + z + "/" + columnname) === "string") {                                                                                                                                                
                            if (columnname == "Rcnum1" || columnname == "Maktx" || columnname == "Tipo" || columnname == "Principal" || columnname == "MatnrIns")  {                                                                                           
                                oFilter.push(new sap.ui.model.Filter(columnname, content, value));                                                                                                                                                             
                            }                                                                                                                                                                                                                                  
                        }                                                                                                                                                                                                                                      
                    }&nbsp;                                                                                                                                                                                                                                    
                }                                                                                                                                                                                                                                              
               }                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            var allFilters = new sap.ui.model.Filter(oFilter, false);                                                                                                                                                                                          
            oTable.getBinding("rows").filter(allFilters);                                                                                                                                                                                                      
            //Sequeira - Only Visible until max 8...                                                                                                                                                                                                           
            var len = oTable.getBinding("rows").getLength();                                                                                                                                                                                                   
            if (len > 8){                                                                                                                                                                                                                                      
            	oTable.setVisibleRowCount(8);                                                                                                                                                                                                                     
            } else {                                                                                                                                                                                                                                           
            	oTable.setVisibleRowCount(len);                                                                                                                                                                                                                   
            }                                                                                                                                                                                                                                                  
            //Sequeira                                                                                                                                                                                                                                         
        },                                                                                                                                                                                                                                                     
        /**&nbsp;                                                                                                                                                                                                                                              
         * Reset Table Filter/Search. Common for all Tables.                                                                                                                                                                                                   
         * @param {object} oEvent - Object of the source control.&nbsp;                                                                                                                                                                                        
         * @param {object} that - current view context                                                                                                                                                                                                         
         * @public                                                                                                                                                                                                                                             
         */                                                                                                                                                                                                                                                    
        onReset: function(oEvent) {                                                                                                                                                                                                                            
            var that = this;                                                                                                                                                                                                                                   
            var cid = oEvent.getSource().sId;                                                                                                                                                                                                                  
            var searchFilterId = $("#" + cid).prev().attr("id");                                                                                                                                                                                               
            sap.ui.getCore().byId(searchFilterId).setValue('');                                                                                                                                                                                                
            var oCont = oEvent.getSource();                                                                                                                                                                                                                    
            var oTable = that.getView().byId(oCont.data("table"));                                                                                                                                                                                             
            var columns = oTable.getColumns();                                                                                                                                                                                                                 
            var len = columns.length;                                                                                                                                                                                                                          
            for (var i = 0; i < len; i++) {                                                                                                                                                                                                                    
                columns[i].setFilterValue("").setFiltered(false).setSorted(false);                                                                                                                                                                             
            }                                                                                                                                                                                                                                                  
            oTable.getBinding("rows").filter(null).sort(null);                                                                                                                                                                                                 
            /*var tableId =  this.getView().byId("d_cropseatableId");                                                                                                                                                                                          
				  var count= tableId._getRowCount();                                                                                                                                                                                                                       
				  //sap.ui.getCore().getModel("globalM").setProperty("/masterListCount",'('+count+')')                                                                                                                                                                     
				 this.getView().byId("appCropSeason_Id").setTitle("Crop Assignments(" + count + ")");*/                                                                                                                                                                    
        },                                                                                                                                                                                                                                                     
        sInputValue : "",                                                                                                                                                                                                                                      
        oReplicarObject : {},                                                                                                                                                                                                                                  
        onChange: function(oEvent) {                                                                                                                                                                                                                           
            debugger                                                                                                                                                                                                                                           
            var oPath = oEvent.getSource().getBindingContext().sPath;                                                                                                                                                                                          
            //Sequeira                                                                                                                                                                                                                                         
            var res = oPath.split("/");                                                                                                                                                                                                                        
            this.prdpath = parseInt(res[2]);&nbsp;                                                                                                                                                                                                             
            //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                 
            var oObject = oEvent.getSource().getBindingContext().getObject();                                                                                                                                                                                  
            var oField = oEvent.getSource().getBinding("value").sPath;                                                                                                                                                                                         
            var newValue = oEvent.getParameter("newValue");                                                                                                                                                                                                    
            var oTable = this.oView.byId("idTableResumo");                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            this.oFieldReplicar = oField;                                                                                                                                                                                                                      
            this.oReplicarObject = oObject;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                  
            var a = newValue.replace(",", ".");                                                                                                                                                                                                                
            var x;                                                                                                                                                                                                                                             
            var y;                                                                                                                                                                                                                                             
            x = parseFloat(a).toFixed(2);                                                                                                                                                                                                                      
            this.sInputValue = x;                                                                                                                                                                                                                              
            this.oView.byId("idTabProdutos").getModel().setProperty(oPath + "/" + oField, x);                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            //Sequeira                                                                                                                                                                                                                                         
            var res = oField.replace("D", "");                                                                                                                                                                                                                 
            var res = res.replace("P", "");                                                                                                                                                                                                                    
            res = "/" + res;                                                                                                                                                                                                                                   
            var boundObject = this.getView().getModel('modelYearMonth').getProperty(res);                                                                                                                                                                      
            this.myMonth = boundObject;                                                                                                                                                                                                                        
            var boundObject2 = this.getView().getModel('modelYearMonth').getProperty("/M1");                                                                                                                                                                   
            this.firstMonth = boundObject2;                                                                                                                                                                                                                    
            //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            var oReplicar = this.oView.byId("idReplicar");                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            if (oObject.Principal === 'X' && oReplicar.getSelected() === true) {                                                                                                                                                                               
                oReplicar.fireSelect();                                                                                                                                                                                                                        
            } else {                                                                                                                                                                                                                                           
            	this.onSave();	                                                                                                                                                                                                                                   
            }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                          
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        onSaveProdutos: function(oEvent) {                                                                                                                                                                                                                     
            this.oView.byId("idTableResumo").setBusy(true);                                                                                                                                                                                                    
            this.oView.byId("idTableResumo").setBusyIndicatorDelay(0);                                                                                                                                                                                         
            this.oView.byId("idTableCusto").setBusy(true);                                                                                                                                                                                                     
            this.oView.byId("idTableCusto").setBusyIndicatorDelay(0);                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
            var that = this;                                                                                                                                                                                                                                   
            this.oEvent = oEvent;                                                                                                                                                                                                                              
            var sMatnr;                                                                                                                                                                                                                                        
            var oTable = this.oView.byId("idTableQtdeProdutos");                                                                                                                                                                                               
            var oModel = models.callBackEnd();                                                                                                                                                                                                                 
            if (oEvent !== undefined) {                                                                                                                                                                                                                        
                var z = true;                                                                                                                                                                                                                                  
            } else {                                                                                                                                                                                                                                           
                z = false;                                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            var x;                                                                                                                                                                                                                                             
            //Sequeira                                                                                                                                                                                                                                         
            var saveall = this.oView.byId("idSaveAllQtd").getSelected();                                                                                                                                                                                       
            //Sequeira                                                                                                                                                                                                                                         
            for (var z = 0; z < oTable.getModel().getData().modelProdutos.length; z++) {                                                                                                                                                                       
                var line = oTable.getModel().getData().modelProdutos[z];                                                                                                                                                                                       
                delete line.__metadata;                                                                                                                                                                                                                        
                //Sequeira                                                                                                                                                                                                                                     
                if (!saveall) {                                                                                                                                                                                                                                
                 if (z != this.prdpath){                                                                                                                                                                                                                       
                    continue;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                              
                 }                                                                                                                                                                                                                                             
                }                                                                                                                                                                                                                                              
               //Sequeira                                                                                                                                                                                                                                      
                //line.Werks = sap.ui.getCore().dadosMaster.Werks;                                                                                                                                                                                             
                line.Acnum = sap.ui.getCore().dadosMaster.Acnum;                                                                                                                                                                                               
                //Sequeira                                                                                                                                                                                                                                     
                line.Extwg = sap.ui.getCore().dadosProcessoId;                                                                                                                                                                                                 
                //line.Extwg = sap.ui.getCore().dadosProcesso;                                                                                                                                                                                                 
                //Sequeira                                                                                                                                                                                                                                     
                line.Matkl = sap.ui.getCore().dadosDetail.Matkl;                                                                                                                                                                                               
                sMatnr = line.Matnr;                                                                                                                                                                                                                           
                //	line.Rcnum = this.oView.byId("idReceita").getValue();                                                                                                                                                                                       
                //	line.Rctex = this.oView.byId("idRecDescr").getText();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                   
                line.Begda = this.lv_begda;                                                                                                                                                                                                                    
                line.Endda = this.lv_endda;                                                                                                                                                                                                                    
                line.Produtos = 'X';                                                                                                                                                                                                                           
                //Sequeira                                                                                                                                                                                                                                     
                line.Versao = that.myversion;                                                                                                                                                                                                                  
                line.Period = this.myMonth;                                                                                                                                                                                                                    
                //New field and period when checkbox selected                                                                                                                                                                                                  
                line.Massa  = '';                                                                                                                                                                                                                              
                if (saveall){                                                                                                                                                                                                                                  
                line.Massa  = 'X';                                                                                                                                                                                                                             
                line.Period = this.firstMonth;                                                                                                                                                                                                                 
                }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                              
                //Sequeira                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                oModel.create("/GetProdutosSet", line);                                                                                                                                                                                                        
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            oModel.submitChanges();                                                                                                                                                                                                                            
            oModel.attachBatchRequestCompleted(function(oData, fnFunction, oListener) {                                                                                                                                                                        
                if (that.oEvent != undefined) {                                                                                                                                                                                                                
                    var bCompact = !!that.getView().$().closest(".sapUiSizeCompact").length;                                                                                                                                                                   
                    sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                          
                    MessageBox.success(                                                                                                                                                                                                                        
                        "Receita salva com sucesso", {                                                                                                                                                                                                         
                            styleClass: bCompact ? "sapUiSizeCompact" : ""                                                                                                                                                                                     
                        }                                                                                                                                                                                                                                      
                    );                                                                                                                                                                                                                                         
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                // atualiza resumo                                                                                                                                                                                                                             
                that.oModel.read("/GetResumoOrcSet", {                                                                                                                                                                                                         
                    filters: that.oFilters,                                                                                                                                                                                                                    
                    success: function(oData1) {                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                        var json0 = new JSONModel();                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                        json0.setData({                                                                                                                                                                                                                        
                            modelResumo: oData1.results                                                                                                                                                                                                        
                        });                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                        that.oView.byId("idTableResumo").setModel(json0);                                                                                                                                                                                      
                        that.oView.byId("idTableResumo").bindRows("/modelResumo");                                                                                                                                                                             
                        that.oView.byId("idTableResumo").setEnableBusyIndicator(false);                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                        var oFilters = [];                                                                                                                                                                                                                     
                        oFilters.push(new sap.ui.model.Filter("Begda", "EQ", that.lv_begda));                                                                                                                                                                  
                        oFilters.push(new sap.ui.model.Filter("Endda", "EQ", that.lv_endda));                                                                                                                                                                  
                        oFilters.push(new sap.ui.model.Filter("Werks", "EQ", line.Werks));                                                                                                                                                                     
                        //	oFilters.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                 
                        var oFilters1 = [];                                                                                                                                                                                                                    
                        oFilters1.push(new sap.ui.model.Filter("Begda", "EQ", that.lv_begda));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Endda", "EQ", that.lv_endda));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Werks", "EQ", line.Werks));                                                                                                                                                                    
                        //	oFilters.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum1", "EQ", that.sRcnum1));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum2", "EQ", that.sRcnum2));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum3", "EQ", that.sRcnum3));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum4", "EQ", that.sRcnum4));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum5", "EQ", that.sRcnum5));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum6", "EQ", that.sRcnum6));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum7", "EQ", that.sRcnum7));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum8", "EQ", that.sRcnum8));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum9", "EQ", that.sRcnum9));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum10", "EQ", that.sRcnum10));                                                                                                                                                               
                        oFilters1.push(new sap.ui.model.Filter("Matnr", "EQ", sMatnr));                                                                                                                                                                        
                        //Sequeira                                                                                                                                                                                                                             
                        oFilters1.push(new sap.ui.model.Filter("Versao", "EQ", that.myversion));                                                                                                                                                               
                        //Sequeira                                                                                                                                                                                                                             
                        that.oModel.read("/CustoReceitaSet", {                                                                                                                                                                                                 
                            filters: oFilters1,                                                                                                                                                                                                                
                            success: function(oData2) {                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                                var json1 = new JSONModel();                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
                                json1.setData({                                                                                                                                                                                                                
                                    modelCusto: oData2.results                                                                                                                                                                                                 
                                });                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                                that.oView.byId("idTableCusto").setModel(json1);                                                                                                                                                                               
                                that.oView.byId("idTableCusto").bindRows("/modelCusto");                                                                                                                                                                       
                                that.oView.byId("idTableCusto").setEnableBusyIndicator(false);                                                                                                                                                                 
                            },                                                                                                                                                                                                                                 
                            error: function(oError) {                                                                                                                                                                                                          
                            	//Sequeira                                                                                                                                                                                                                        
                                that.oView.byId("idTableCusto").setEnableBusyIndicator(false);                                                                                                                                                                 
                                //Sequeira                                                                                                                                                                                                                     
                            }                                                                                                                                                                                                                                  
                        });                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                    },                                                                                                                                                                                                                                         
                    error: function(oError) {                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                    },                                                                                                                                                                                                                                         
                });                                                                                                                                                                                                                                            
            });                                                                                                                                                                                                                                                
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onSave: function(oEvent) {                                                                                                                                                                                                                             
            this.oView.byId("idTableResumo").setBusy(true);                                                                                                                                                                                                    
            this.oView.byId("idTableResumo").setBusyIndicatorDelay(0);                                                                                                                                                                                         
            this.oView.byId("idTableCusto").setBusy(true);                                                                                                                                                                                                     
            this.oView.byId("idTableCusto").setBusyIndicatorDelay(0);                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
            var that = this;                                                                                                                                                                                                                                   
            this.oEvent = oEvent;                                                                                                                                                                                                                              
            var sMatnr;                                                                                                                                                                                                                                        
            var oTable = this.oView.byId("idTabProdutos");                                                                                                                                                                                                     
            var oModel = models.callBackEnd();                                                                                                                                                                                                                 
            if (oEvent !== undefined) {                                                                                                                                                                                                                        
                var z = true;                                                                                                                                                                                                                                  
            } else {                                                                                                                                                                                                                                           
                z = false;                                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            var x;                                                                                                                                                                                                                                             
            //Sequeira                                                                                                                                                                                                                                         
            var saveall = this.oView.byId("idSaveAllPrd").getSelected();                                                                                                                                                                                       
            //If replicar is on, then do not consider performance boost...                                                                                                                                                                                     
            var actReplicar = this.oView.byId("idReplicar").getSelected();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                             
            //Sequeira                                                                                                                                                                                                                                         
            for (var z = 0; z < oTable.getModel().getData().modelProdutos.length; z++) {                                                                                                                                                                       
                var line = oTable.getModel().getData().modelProdutos[z];                                                                                                                                                                                       
                delete line.__metadata;                                                                                                                                                                                                                        
                //Sequeira                                                                                                                                                                                                                                     
                //Only consider now, if REPLICAR is not on...                                                                                                                                                                                                  
                if (!actReplicar){                                                                                                                                                                                                                             
                 if (!saveall) {                                                                                                                                                                                                                               
                  if (z != this.prdpath){                                                                                                                                                                                                                      
                     continue;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                             
                  }                                                                                                                                                                                                                                            
                 }                                                                                                                                                                                                                                             
                }                                                                                                                                                                                                                                              
                //Sequeira                                                                                                                                                                                                                                     
                 //line.Werks = sap.ui.getCore().dadosMaster.Werks;                                                                                                                                                                                            
                line.Acnum = sap.ui.getCore().dadosMaster.Acnum;                                                                                                                                                                                               
                //Sequeira                                                                                                                                                                                                                                     
                line.Extwg = sap.ui.getCore().dadosProcessoId;                                                                                                                                                                                                 
                //line.Extwg = sap.ui.getCore().dadosProcesso;                                                                                                                                                                                                 
                //Sequeira                                                                                                                                                                                                                                     
                line.Matkl = sap.ui.getCore().dadosDetail.Matkl;                                                                                                                                                                                               
                //	line.Matnr = that.MatnrG;                                                                                                                                                                                                                   
                //	line.Rcnum = this.oView.byId("idReceita").getValue();                                                                                                                                                                                       
                //line.Rctex = this.oView.byId("idRecDescr").getText();                                                                                                                                                                                        
                line.Begda = this.lv_begda;                                                                                                                                                                                                                    
                line.Endda = this.lv_endda;                                                                                                                                                                                                                    
                //Sequeira                                                                                                                                                                                                                                     
                line.Versao = this.myversion;                                                                                                                                                                                                                  
                line.Period = this.myMonth;                                                                                                                                                                                                                    
                //New field and period when checkbox selected                                                                                                                                                                                                  
                line.Massa  = '';                                                                                                                                                                                                                              
                if (saveall){                                                                                                                                                                                                                                  
                line.Massa  = 'X';                                                                                                                                                                                                                             
                line.Period = this.firstMonth;                                                                                                                                                                                                                 
                }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                              
                //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                     
                sMatnr = line.Matnr;                                                                                                                                                                                                                           
                oModel.create("/GetProdutosSet", line);                                                                                                                                                                                                        
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            oModel.submitChanges();                                                                                                                                                                                                                            
            oModel.attachBatchRequestCompleted(function(oData, fnFunction, oListener) {                                                                                                                                                                        
                if (that.oEvent != undefined) {                                                                                                                                                                                                                
                    var bCompact = !!that.getView().$().closest(".sapUiSizeCompact").length;                                                                                                                                                                   
                    sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                          
                    MessageBox.success(                                                                                                                                                                                                                        
                        "Receita salva com sucesso", {                                                                                                                                                                                                         
                            styleClass: bCompact ? "sapUiSizeCompact" : ""                                                                                                                                                                                     
                        }                                                                                                                                                                                                                                      
                    );                                                                                                                                                                                                                                         
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                // atualiza resumo                                                                                                                                                                                                                             
                that.oModel.read("/GetResumoOrcSet", {                                                                                                                                                                                                         
                    filters: that.oFilters,                                                                                                                                                                                                                    
                    success: function(oData1) {                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                        var json0 = new JSONModel();                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                        json0.setData({                                                                                                                                                                                                                        
                            modelResumo: oData1.results                                                                                                                                                                                                        
                        });                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                        that.oView.byId("idTableResumo").setModel(json0);                                                                                                                                                                                      
                        that.oView.byId("idTableResumo").bindRows("/modelResumo");                                                                                                                                                                             
                        that.oView.byId("idTableResumo").setEnableBusyIndicator(false);                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                        var oFilters = [];                                                                                                                                                                                                                     
                        oFilters.push(new sap.ui.model.Filter("Begda", "EQ", that.lv_begda));                                                                                                                                                                  
                        oFilters.push(new sap.ui.model.Filter("Endda", "EQ", that.lv_endda));                                                                                                                                                                  
                        oFilters.push(new sap.ui.model.Filter("Werks", "EQ", line.Werks));                                                                                                                                                                     
                        //	oFilters.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                 
                        var oFilters1 = [];                                                                                                                                                                                                                    
                        oFilters1.push(new sap.ui.model.Filter("Begda", "EQ", that.lv_begda));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Endda", "EQ", that.lv_endda));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Werks", "EQ", line.Werks));                                                                                                                                                                    
                        //	oFilters.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum1", "EQ", that.sRcnum1));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum2", "EQ", that.sRcnum2));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum3", "EQ", that.sRcnum3));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum4", "EQ", that.sRcnum4));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum5", "EQ", that.sRcnum5));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum6", "EQ", that.sRcnum6));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum7", "EQ", that.sRcnum7));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum8", "EQ", that.sRcnum8));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum9", "EQ", that.sRcnum9));                                                                                                                                                                 
                        oFilters1.push(new sap.ui.model.Filter("Rcnum10", "EQ", that.sRcnum10));                                                                                                                                                               
                        oFilters1.push(new sap.ui.model.Filter("Matnr", "EQ", sMatnr));                                                                                                                                                                        
                        //Sequeira                                                                                                                                                                                                                             
                        oFilters1.push(new sap.ui.model.Filter("Versao", "EQ", that.myversion));                                                                                                                                                               
                        //Sequeira                                                                                                                                                                                                                             
                        that.oModel.read("/CustoReceitaSet", {                                                                                                                                                                                                 
                            filters: oFilters1,                                                                                                                                                                                                                
                            success: function(oData2) {                                                                                                                                                                                                        
                                var json1 = new JSONModel();                                                                                                                                                                                                   
                                json1.setData({                                                                                                                                                                                                                
                                    modelCusto: oData2.results                                                                                                                                                                                                 
                                });                                                                                                                                                                                                                            
                                that.oView.byId("idTableCusto").setModel(json1);                                                                                                                                                                               
                                that.oView.byId("idTableCusto").bindRows("/modelCusto");                                                                                                                                                                       
                                that.oView.byId("idTableCusto").setEnableBusyIndicator(false);                                                                                                                                                                 
                            },                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
                            error: function(oError) {                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                            }                                                                                                                                                                                                                                  
                        });                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                    },                                                                                                                                                                                                                                         
                    error: function(oError) {                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                    },                                                                                                                                                                                                                                         
                });                                                                                                                                                                                                                                            
            });                                                                                                                                                                                                                                                
        },                                                                                                                                                                                                                                                     
        onNavBack: function() {                                                                                                                                                                                                                                
            var sPreviousHash = History.getInstance().getPreviousHash();                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
            if (sPreviousHash !== undefined) {                                                                                                                                                                                                                 
                window.history.go(-1);                                                                                                                                                                                                                         
            } else {                                                                                                                                                                                                                                           
                this.getOwnerComponent().getRouter()                                                                                                                                                                                                           
                    .navTo("Detail1", {                                                                                                                                                                                                                        
                        Acnum: sap.ui.getCore().dadosMaster.Acnum                                                                                                                                                                                              
                    }, !Device.system.phone);                                                                                                                                                                                                                  
            }                                                                                                                                                                                                                                                  
        },                                                                                                                                                                                                                                                     
        onValueHelpRequested: function() {                                                                                                                                                                                                                     
            debugger                                                                                                                                                                                                                                           
            sap.ui.core.BusyIndicator.show(0);                                                                                                                                                                                                                 
            var that = this;                                                                                                                                                                                                                                   
            var oFilters = [];                                                                                                                                                                                                                                 
            //this._oInput = this.oView.byId("idReceita");                                                                                                                                                                                                     
            oFilters.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Matnr", "EQ", sap.ui.getCore().dadosDetail.Matnr));                                                                                                                                                         
                                                                                                                                                                                                                                                               
            this.oModel.read("/GetReceitasSet", {                                                                                                                                                                                                              
                filters: oFilters,                                                                                                                                                                                                                             
                success: function(oData) {                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                    that.oReceitaModel = new JSONModel();                                                                                                                                                                                                      
                    that.oReceitaModel.setData({                                                                                                                                                                                                               
                        receita: oData.results                                                                                                                                                                                                                 
                    });                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                    var oCols = {                                                                                                                                                                                                                              
                        "cols": [{                                                                                                                                                                                                                             
                            "label": "Receita ID",                                                                                                                                                                                                             
                            "template": "Rcnum",                                                                                                                                                                                                               
                            "width": "100px"                                                                                                                                                                                                                   
                        }, {                                                                                                                                                                                                                                   
                            "label": "Material",                                                                                                                                                                                                               
                            "template": "Matnr",                                                                                                                                                                                                               
                            "width": "100px"                                                                                                                                                                                                                   
                        }, {                                                                                                                                                                                                                                   
                            "label": "Tipo",                                                                                                                                                                                                                   
                            "template": "Tipo",                                                                                                                                                                                                                
                            "width": "150px"                                                                                                                                                                                                                   
                        }, {                                                                                                                                                                                                                                   
                            "label": "Descri??o",                                                                                                                                                                                                              
                            "template": "Rctex"                                                                                                                                                                                                                
                        }]                                                                                                                                                                                                                                     
                    };                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                    that.oColsModel = new JSONModel();                                                                                                                                                                                                         
                    that.oColsModel.setData(oCols);                                                                                                                                                                                                            
                    var aCols = that.oColsModel.getData().cols;                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                    that._oValueHelpDialog = sap.ui.xmlfragment(that.createId("idVH"), "com.vistex.zagriplan.view.ValueHelp", that);                                                                                                                           
                    that.getView().addDependent(that._oValueHelpDialog);                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                    that._oValueHelpDialog.getTableAsync().then(function(oTable) {                                                                                                                                                                             
                        oTable.setModel(that.oReceitaModel);                                                                                                                                                                                                   
                        oTable.setModel(that.oColsModel, "columns");                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                        if (oTable.bindRows) {                                                                                                                                                                                                                 
                            oTable.bindAggregation("rows", "/receita");                                                                                                                                                                                        
                        }                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                        if (oTable.bindItems) {                                                                                                                                                                                                                
                            oTable.bindAggregation("items", "/receita", function() {                                                                                                                                                                           
                                return new ColumnListItem({                                                                                                                                                                                                    
                                    cells: aCols.map(function(column) {                                                                                                                                                                                        
                                        return new Label({                                                                                                                                                                                                     
                                            text: "{" + column.template + "}"                                                                                                                                                                                  
                                        });                                                                                                                                                                                                                    
                                    })                                                                                                                                                                                                                         
                                });                                                                                                                                                                                                                            
                            });                                                                                                                                                                                                                                
                        }                                                                                                                                                                                                                                      
                        that._oValueHelpDialog.update();                                                                                                                                                                                                       
                    }.bind(that));                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                    var oToken = new Token();                                                                                                                                                                                                                  
                    oToken.setKey(that._oInput.getSelectedKey());                                                                                                                                                                                              
                    oToken.setText(that._oInput.getValue());                                                                                                                                                                                                   
                    that._oValueHelpDialog.setTokens([oToken]);                                                                                                                                                                                                
                    sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                          
                    that._oValueHelpDialog.open();                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                },                                                                                                                                                                                                                                             
                error: function(oError) {                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                }                                                                                                                                                                                                                                              
            });                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        onRemoveStyleClass: function() {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                               
        onReplicar: function(oEvent) {                                                                                                                                                                                                                         
            var sModel = this.oView.byId("idTabProdutos").getModel();                                                                                                                                                                                          
            var oTable = this.oView.byId("idTabProdutos");                                                                                                                                                                                                     
            var x;                                                                                                                                                                                                                                             
            var valP;                                                                                                                                                                                                                                          
            var fieldM;                                                                                                                                                                                                                                        
            var fieldV;                                                                                                                                                                                                                                        
            var oObject;                                                                                                                                                                                                                                       
            var tableM =  oTable.getModel().getData().modelProdutos;                                                                                                                                                                                           
            if (oEvent.getSource().getProperty("selected") === true) {                                                                                                                                                                                         
                //				for (var y = 1; y <= 12; y++) {                                                                                                                                                                                                          
                fieldM = "/" + this.oFieldReplicar;                                                                                                                                                                                                            
                fieldV = this.oFieldReplicar;                                                                                                                                                                                                                  
                oObject = this.oReplicarObject;                                                                                                                                                                                                                
                var receita = oObject.Rcnum1;                                                                                                                                                                                                                  
                var value = this.sInputValue;                                                                                                                                                                                                                  
               // valP = oTable.getModel().getData().modelProdutos[0][fieldV];                                                                                                                                                                                 
                tableM.forEach(function(item,i){                                                                                                                                                                                                               
                	if(receita === item.Rcnum1){                                                                                                                                                                                                                  
                	oTable.getModel().setProperty("/modelProdutos/" + i + fieldM, value);                                                                                                                                                                         
                	}                                                                                                                                                                                                                                             
                });                                                                                                                                                                                                                                            
                         /* for (x = 1; x < tableM.length; x++) {                                                                                                                                                                                              
                	                                                                                                                                                                                                                                              
                    oTable.getModel().setProperty("/modelProdutos/" + x + fieldM, valP);                                                                                                                                                                       
                }                                                                                                                                                                                                                                              
                //				}                                                                                                                                                                                                                                        
*/                                                                                                                                                                                                                                                             
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            this.onSave();                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
        onProdutos: function(oEvent) {                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
            if (oEvent.getSource().getProperty("selected") === true) {                                                                                                                                                                                         
                this.oView.byId("idTableQtdeProdutos").setVisible(true);                                                                                                                                                                                       
                this.oView.byId("idTabProdutos").setVisible(false);                                                                                                                                                                                            
                this.oView.byId("idReplicar").setVisible(false);                                                                                                                                                                                               
                this.onGetProdutos();                                                                                                                                                                                                                          
            } else {                                                                                                                                                                                                                                           
                this.oView.byId("idTableQtdeProdutos").setVisible(false);                                                                                                                                                                                      
                this.oView.byId("idTabProdutos").setVisible(true);                                                                                                                                                                                             
                this.oView.byId("idReplicar").setVisible(true);                                                                                                                                                                                                
                this.onGetProdutos();                                                                                                                                                                                                                          
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onGetProdutos: function() {                                                                                                                                                                                                                            
            var that = this;                                                                                                                                                                                                                                   
            var oFilters = [];                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            oFilters.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Acnum", "EQ", sap.ui.getCore().dadosMaster.Acnum));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Extwg", "EQ", sap.ui.getCore().dadosProcessoId));                                                                                                                                                           
            oFilters.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Matnr", "EQ", sap.ui.getCore().dadosDetail.Matnr));                                                                                                                                                         
            //oFilters.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                              
                                                                                                                                                                                                                                                               
            var date = that.addDays(sap.ui.getCore().dadosMaster.Datbi, 1);                                                                                                                                                                                    
            //	var lv_begda = date.toISOString().substr(0, 4) + date.toISOString().substr(5, 2) + date.toISOString().substr(8, 2);                                                                                                                             
            var lv_begda = sap.ui.getCore().dadosMaster.Datab.toISOString().substr(0, 4) + sap.ui.getCore().dadosMaster.Datab.toISOString().substr(                                                                                                            
                5, 2) + sap.ui.getCore().dadosMaster.Datab.toISOString().substr(8, 2);                                                                                                                                                                         
            var lv_year = date.getUTCFullYear() + 1;                                                                                                                                                                                                           
            //	var lv_endda = lv_year + date.toLocaleDateString().substr(3, 2) + date.toLocaleDateString().substr(0, 2);                                                                                                                                       
            var lv_endda = sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(0, 4) + sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(                                                                                                            
                    5, 2) +                                                                                                                                                                                                                                    
                sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(8, 2);                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            oFilters.push(new sap.ui.model.Filter("Begda", "EQ", lv_begda));                                                                                                                                                                                   
            oFilters.push(new sap.ui.model.Filter("Endda", "EQ", lv_endda));                                                                                                                                                                                   
            oFilters.push(new sap.ui.model.Filter("Rcnum1", "EQ", that.sRcnum1));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum2", "EQ", that.sRcnum2));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum3", "EQ", that.sRcnum3));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum4", "EQ", that.sRcnum4));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum5", "EQ", that.sRcnum5));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum6", "EQ", that.sRcnum6));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum7", "EQ", that.sRcnum7));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum8", "EQ", that.sRcnum8));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum9", "EQ", that.sRcnum9));                                                                                                                                                                              
            oFilters.push(new sap.ui.model.Filter("Rcnum10", "EQ", that.sRcnum10));                                                                                                                                                                            
            //Sequeira                                                                                                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Versao", "EQ", that.myversion));                                                                                                                                                                            
            //Sequeira                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
            this.oModel.read("/GetProdutosSet", {                                                                                                                                                                                                              
                filters: oFilters,                                                                                                                                                                                                                             
                success: function(oData) {                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                    var json = new JSONModel();                                                                                                                                                                                                                
                    json.setData({                                                                                                                                                                                                                             
                        modelProdutos: oData.results                                                                                                                                                                                                           
                    });                                                                                                                                                                                                                                        
                    that.oView.byId("idTabProdutos").setModel(json);                                                                                                                                                                                           
                    //Sequeira                                                                                                                                                                                                                                 
                    var len = oData.results.length;                                                                                                                                                                                                            
                    if (len > 8){                                                                                                                                                                                                                              
                    	len = 8;	                                                                                                                                                                                                                                 
                    }&nbsp;                                                                                                                                                                                                                                    
                    //Sequeira                                                                                                                                                                                                                                 
                    that.oView.byId("idTabProdutos").setVisibleRowCount(len);//(oData.results.length);                                                                                                                                                         
                    that.oView.byId("idTabProdutos").bindRows("/modelProdutos");                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                    that.oView.byId("idTableQtdeProdutos").setModel(json);                                                                                                                                                                                     
                    that.oView.byId("idTableQtdeProdutos").setVisibleRowCount(len);//(oData.results.length);                                                                                                                                                   
                    that.oView.byId("idTableQtdeProdutos").bindRows("/modelProdutos");                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                    that.oModel.read("/CustoReceitaSet", {                                                                                                                                                                                                     
                        filters: oFilters,                                                                                                                                                                                                                     
                        success: function(oData2) {                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                            var json1 = new JSONModel();                                                                                                                                                                                                       
                            json1.setData({                                                                                                                                                                                                                    
                                modelCusto: oData2.results                                                                                                                                                                                                     
                            });                                                                                                                                                                                                                                
                            that.oView.byId("idTableCusto").setModel(json1);                                                                                                                                                                                   
                            that.oView.byId("idTableCusto").bindRows("/modelCusto");                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                            //	that._oValueHelpDialog.close();                                                                                                                                                                                                 
                            //	var InputValue = this.oView.byId("idReceita").getValue();                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                            sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                  
                        },                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                        error: function(oError) {                                                                                                                                                                                                              
                        	//Sequeira                                                                                                                                                                                                                            
                            that.oView.byId("idTableCusto").setEnableBusyIndicator(false);                                                                                                                                                                     
                            //Sequeira                                                                                                                                                                                                                         
                        }                                                                                                                                                                                                                                      
                    });                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                },                                                                                                                                                                                                                                             
                error: function(oError) {                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                }                                                                                                                                                                                                                                              
            });                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onValueHelpOkPress: function(oEvent) {                                                                                                                                                                                                                 
            debugger                                                                                                                                                                                                                                           
            var that = this;                                                                                                                                                                                                                                   
            sap.ui.core.BusyIndicator.show(0);                                                                                                                                                                                                                 
            var aTokens = oEvent.getParameter("tokens");                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
            for (var x = 0; x < this.oView.byId("idTabProdutos").getRows().length; x++) {                                                                                                                                                                      
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[2].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[4].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[6].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[8].removeStyleClass("changeYellow");                                                                                                                                                  
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[10].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[12].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[14].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[16].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[18].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[20].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[22].removeStyleClass("changeYellow");                                                                                                                                                 
                this.oView.byId("idTabProdutos").getRows()[x].getCells()[24].removeStyleClass("changeYellow");                                                                                                                                                 
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            this.oView.byId("idTabProdutos").unbindRows();                                                                                                                                                                                                     
            this.oView.byId("idTableCusto").unbindRows();                                                                                                                                                                                                      
            this.oView.byId("idTableQtdeProdutos").unbindRows();                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            this.oView.byId("idRecDescr").setText(aTokens[0].getText());                                                                                                                                                                                       
            //	this.oView.byId("idReceita").setValue(aTokens[0].getKey());                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            //			sap.ui.getCore().receita = oEvent.getSource().getTable().getModel().getData().receita[oEvent.getSource().getTable().getSelectedIndex()];                                                                                                      
                                                                                                                                                                                                                                                               
            var oFilters = [];                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            oFilters.push(new sap.ui.model.Filter("Werks", "EQ", sap.ui.getCore().dadosMaster.Werks));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Acnum", "EQ", sap.ui.getCore().dadosMaster.Acnum));                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Extwg", "EQ", sap.ui.getCore().dadosProcessoId));                                                                                                                                                           
            oFilters.push(new sap.ui.model.Filter("Matkl", "EQ", sap.ui.getCore().dadosDetail.Matkl));                                                                                                                                                         
            //	oFilters.push(new sap.ui.model.Filter("Rcnum", "EQ", that.sRcnum));                                                                                                                                                                             
                                                                                                                                                                                                                                                               
            var date = that.addDays(sap.ui.getCore().dadosMaster.Datbi, 1);                                                                                                                                                                                    
            //	var lv_begda = date.toISOString().substr(0, 4) + date.toISOString().substr(5, 2) + date.toISOString().substr(8, 2);                                                                                                                             
            var lv_begda = sap.ui.getCore().dadosMaster.Datab.toISOString().substr(0, 4) + sap.ui.getCore().dadosMaster.Datab.toISOString().substr(                                                                                                            
                5, 2) + sap.ui.getCore().dadosMaster.Datab.toISOString().substr(8, 2);                                                                                                                                                                         
            var lv_year = date.getUTCFullYear() + 1;                                                                                                                                                                                                           
            //	var lv_endda = lv_year + date.toLocaleDateString().substr(3, 2) + date.toLocaleDateString().substr(0, 2);                                                                                                                                       
            var lv_endda = sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(0, 4) + sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(                                                                                                            
                    5, 2) +                                                                                                                                                                                                                                    
                sap.ui.getCore().dadosMaster.Datbi.toISOString().substr(8, 2);                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            oFilters.push(new sap.ui.model.Filter("Begda", "EQ", lv_begda));                                                                                                                                                                                   
            oFilters.push(new sap.ui.model.Filter("Endda", "EQ", lv_endda));                                                                                                                                                                                   
            //Sequeira                                                                                                                                                                                                                                         
            oFilters.push(new sap.ui.model.Filter("Versao", "EQ", that.myversion));                                                                                                                                                                            
            //Sequeira                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
            this.oModel.read("/GetProdutosSet", {                                                                                                                                                                                                              
                filters: oFilters,                                                                                                                                                                                                                             
                success: function(oData) {                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                    var json = new JSONModel();                                                                                                                                                                                                                
                    json.setData({                                                                                                                                                                                                                             
                        modelProdutos: oData.results                                                                                                                                                                                                           
                    });                                                                                                                                                                                                                                        
                    //Sequeira                                                                                                                                                                                                                                 
                    var len = oData.results.length;                                                                                                                                                                                                            
                    if (len > 8){                                                                                                                                                                                                                              
                    	len = 8;	                                                                                                                                                                                                                                 
                    }&nbsp;                                                                                                                                                                                                                                    
                    //Sequeira&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                         
                    that.oView.byId("idTabProdutos").setModel(json);                                                                                                                                                                                           
                    that.oView.byId("idTabProdutos").setVisibleRowCount(len);//(oData.results.length);                                                                                                                                                         
                    that.oView.byId("idTabProdutos").bindRows("/modelProdutos");                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                    that.oView.byId("idTableQtdeProdutos").setModel(json);                                                                                                                                                                                     
                    that.oView.byId("idTableQtdeProdutos").setVisibleRowCount(len);//(oData.results.length);                                                                                                                                                   
                    that.oView.byId("idTableQtdeProdutos").bindRows("/modelProdutos");                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                    that.oModel.read("/CustoReceitaSet", {                                                                                                                                                                                                     
                        filters: oFilters,                                                                                                                                                                                                                     
                        success: function(oData2) {                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                            var json1 = new JSONModel();                                                                                                                                                                                                       
                            json1.setData({                                                                                                                                                                                                                    
                                modelCusto: oData2.results                                                                                                                                                                                                     
                            });                                                                                                                                                                                                                                
                            that.oView.byId("idTableCusto").setModel(json1);                                                                                                                                                                                   
                            that.oView.byId("idTableCusto").bindRows("/modelCusto");                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                            that._oValueHelpDialog.close();                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                            sap.ui.core.BusyIndicator.hide();                                                                                                                                                                                                  
                        },                                                                                                                                                                                                                                     
                        error: function(oError) {}                                                                                                                                                                                                             
                    });                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                },                                                                                                                                                                                                                                             
                error: function(oError) {                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                }                                                                                                                                                                                                                                              
            });                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onValueHelpCancelPress: function() {                                                                                                                                                                                                                   
            this._oValueHelpDialog.close();                                                                                                                                                                                                                    
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        onValueHelpAfterClose: function() {                                                                                                                                                                                                                    
            this._oValueHelpDialog.destroy();                                                                                                                                                                                                                  
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        /**                                                                                                                                                                                                                                                    
         * Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered                                                                                                                                                   
         * (NOT before the first rendering! onInit() is used for that one!).                                                                                                                                                                                   
         * @memberOf com.vistex.zagriplan.WebContent.view.Orcamento                                                                                                                                                                                            
         */                                                                                                                                                                                                                                                    
        //	onBeforeRendering: function() {                                                                                                                                                                                                                     
        //                                                                                                                                                                                                                                                     
        //	},                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        /**                                                                                                                                                                                                                                                    
         * Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.                                                                                                          
         * This hook is the same one that SAPUI5 controls get after being rendered.                                                                                                                                                                            
         * @memberOf com.vistex.zagriplan.WebContent.view.Orcamento                                                                                                                                                                                            
         */                                                                                                                                                                                                                                                    
        //	onAfterRendering: function() {                                                                                                                                                                                                                      
        //                                                                                                                                                                                                                                                     
        //	},                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
        /**                                                                                                                                                                                                                                                    
         * Called when the Controller is destroyed. Use this one to free resources and finalize activities.                                                                                                                                                    
         * @memberOf com.vistex.zagriplan.WebContent.view.Orcamento                                                                                                                                                                                            
         */                                                                                                                                                                                                                                                    
        //	onExit: function() {                                                                                                                                                                                                                                
        //                                                                                                                                                                                                                                                     
        //	}                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
});                                                                                                                                                                                                                                                            