sap.ui.define([                                                                                                                                                                                                                                                
	"com/vistex/zagriplan/util/arcGis",                                                                                                                                                                                                                           
	"com/vistex/zagriplan/model/base",                                                                                                                                                                                                                            
	"sap/ui/model/json/JSONModel"                                                                                                                                                                                                                                 
], function (arcGis, base, JSONModel) {                                                                                                                                                                                                                        
	return {                                                                                                                                                                                                                                                      
		map: null,                                                                                                                                                                                                                                                   
		loading: null,                                                                                                                                                                                                                                               
		mapurl: "https://gis.citrosuco.com.br/server/rest/services/ShpTalhaoCTS/MapServer",                                                                                                                                                                          
		tokenValid : "?Token="+base.token+"",                                                                                                                                                                                                                        
	//	tokenValid: "?Token=odxAWMwPUGgP7CxrWX3zb24CK9bAifl9eLHLgtP_ds3GE0kg9oTI1bhQ_qKV9KKVg5J8IuKvoYOPjbuaDVSuIOQsPGS4sEKFWfi1mmhINmiCdAfpeOQ4yQyJyaUaWSasNQwplfLvKi8bnwEF2p6s8PzXQM8krwF1rcTNyBVt93rLnURfP4995A_tC0v32YVjQG4K416BsodmBl-NCaocdYvMBWuPOj2VKwei0N+
PhdSI.",                                                                                                                                                                                                                                                       
		queryTask : null, // query task                                                                                                                                                                                                                              
		selTerrainGraphics: null, // layer                                                                                                                                                                                                                           
		fillTerrainGraphics: null, // layer                                                                                                                                                                                                                          
		oHighlightedTerrains: {}, // save all highlighted terrains&nbsp;                                                                                                                                                                                             
		oFilledTerrains: {},                                                                                                                                                                                                                                         
		initMap: function (divId, mapId, callback) {                                                                                                                                                                                                                 
			if (this.map) {                                                                                                                                                                                                                                             
				if (callback) {                                                                                                                                                                                                                                            
					callback(this.map);                                                                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			} // if map already initiated                                                                                                                                                                                                                               
			var thiz = this;                                                                                                                                                                                                                                            
			var map;                                                                                                                                                                                                                                                    
			arcGis.require([                                                                                                                                                                                                                                            
				"esri/map",                                                                                                                                                                                                                                                
				"esri/layers/ArcGISDynamicMapServiceLayer",                                                                                                                                                                                                                
				"esri/geometry/Extent",                                                                                                                                                                                                                                    
				"esri/layers/ImageParameters",                                                                                                                                                                                                                             
				"esri/symbols/SimpleFillSymbol",                                                                                                                                                                                                                           
				"esri/symbols/SimpleLineSymbol",                                                                                                                                                                                                                           
				"esri/layers/GraphicsLayer",                                                                                                                                                                                                                               
				"esri/Color",                                                                                                                                                                                                                                              
				"dojo/dom-construct",                                                                                                                                                                                                                                      
				"dojo/on",                                                                                                                                                                                                                                                 
				"dojo/dom",                                                                                                                                                                                                                                                
				"dojo/ready",                                                                                                                                                                                                                                              
				"esri/tasks/QueryTask",                                                                                                                                                                                                                                    
				"dojo/domReady!"                                                                                                                                                                                                                                           
			], function (                                                                                                                                                                                                                                               
				Map, ArcGISDynamicMapServiceLayer, Extent, ImageParameters, SimpleFillSymbol, SimpleLineSymbol, GraphicsLayer,                                                                                                                                             
				Color, domConstruct, on, dom, ready, QueryTask) {                                                                                                                                                                                                          
				var init = function () {                                                                                                                                                                                                                                   
					thiz.loading = dom.byId(mapId); //loading image. id                                                                                                                                                                                                       
					map = new Map(divId, {                                                                                                                                                                                                                                    
						basemap: "satellite",                                                                                                                                                                                                                                    
						logo: false,                                                                                                                                                                                                                                             
						slider: false,                                                                                                                                                                                                                                           
						smartNavigation: false                                                                                                                                                                                                                                   
					});                                                                                                                                                                                                                                                       
					thiz.queryTask = new QueryTask(thiz.mapurl + "/0" + thiz.tokenValid);                                                                                                                                                                                     
					on(map, "update-start", $.proxy(thiz.showLoading, thiz));                                                                                                                                                                                                 
					on(map, "update-end", $.proxy(thiz.hideLoading, thiz));                                                                                                                                                                                                   
					thiz.map = map;                                                                                                                                                                                                                                           
					thiz.selTerrainGraphics = new esri.layers.GraphicsLayer(); //highlighted terrains setBorderColor()                                                                                                                                                        
					thiz.fillTerrainGraphics = new esri.layers.GraphicsLayer();                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
					var imageParameters = new ImageParameters();                                                                                                                                                                                                              
					imageParameters.format = "png32";                                                                                                                                                                                                                         
					var dynamicMapServiceLayer = new ArcGISDynamicMapServiceLayer(thiz.mapurl + thiz.tokenValid, {                                                                                                                                                            
						"opacity": 0.5,                                                                                                                                                                                                                                          
						"imageParameters": imageParameters                                                                                                                                                                                                                       
					});                                                                                                                                                                                                                                                       
					var extent = new Extent({                                                                                                                                                                                                                                 
						"xmin": -49.66919914000991,                                                                                                                                                                                                                              
						"ymin": -23.69773578799909,                                                                                                                                                                                                                              
						"xmax": -46.961915515221435,                                                                                                                                                                                                                             
						"ymax": -19.233775402506065,                                                                                                                                                                                                                             
						"spatialReference": {                                                                                                                                                                                                                                    
							"wkid": 4326                                                                                                                                                                                                                                            
						}                                                                                                                                                                                                                                                        
					});                                                                                                                                                                                                                                                       
					if(!sap.ui.getCore().getModel("gis")){                                                                                                                                                                                                                    
						sap.ui.getCore().setModel(new JSONModel(),"gis");                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					map.setExtent(extent);                                                                                                                                                                                                                                    
					map.addLayer(dynamicMapServiceLayer);                                                                                                                                                                                                                     
					map.on("click", $.proxy(onSelect, thiz));                                                                                                                                                                                                                 
					if (callback) {                                                                                                                                                                                                                                           
						callback(map);                                                                                                                                                                                                                                           
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				ready(init);                                                                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
			function onSelect(event) {                                                                                                                                                                                                                                  
				var thiz = this;                                                                                                                                                                                                                                           
				var map = thiz.map;                                                                                                                                                                                                                                        
				thiz.showLoading();                                                                                                                                                                                                                                        
				arcGis.require(["dojo/_base/array", "esri/tasks/IdentifyTask", "esri/tasks/IdentifyParameters"],                                                                                                                                                           
					function (arrayUtils, IdentifyTask, IdentifyParameters) {                                                                                                                                                                                                 
						var identifyTask, identifyParams;                                                                                                                                                                                                                        
						identifyTask = new IdentifyTask(thiz.mapurl + thiz.tokenValid);                                                                                                                                                                                          
						identifyParams = new IdentifyParameters();                                                                                                                                                                                                               
						identifyParams.tolerance = 3;                                                                                                                                                                                                                            
						identifyParams.returnGeometry = true;                                                                                                                                                                                                                    
						identifyParams.layerIds = [0];                                                                                                                                                                                                                           
						identifyParams.layerOption = IdentifyParameters.LAYER_OPTION_ALL;                                                                                                                                                                                        
						identifyParams.width = map.width;                                                                                                                                                                                                                        
						identifyParams.height = map.height;                                                                                                                                                                                                                      
						identifyParams.geometry = event.mapPoint;                                                                                                                                                                                                                
						identifyParams.mapExtent = map.extent;                                                                                                                                                                                                                   
						var deferred = identifyTask.execute(identifyParams, function (response) {                                                                                                                                                                                
							return arrayUtils.map(response, function (result) {                                                                                                                                                                                                     
								var terrain = result.feature.attributes.CODFAZTAL;                                                                                                                                                                                                     
								var isFill = false,                                                                                                                                                                                                                                    
									isBorder = false,                                                                                                                                                                                                                                     
									oFill = null,                                                                                                                                                                                                                                         
									oBorder = null;                                                                                                                                                                                                                                       
								if (thiz.oHighlightedTerrains.hasOwnProperty(terrain)) {                                                                                                                                                                                               
									isBorder = true;                                                                                                                                                                                                                                      
									oBorder = $.extend({}, thiz.oHighlightedTerrains[terrain]);                                                                                                                                                                                           
								}                                                                                                                                                                                                                                                      
								if (thiz.oFilledTerrains.hasOwnProperty(terrain)) {                                                                                                                                                                                                    
									isFill = true;                                                                                                                                                                                                                                        
									oFill = $.extend({}, thiz.oFilledTerrains[terrain]);                                                                                                                                                                                                  
								}                                                                                                                                                                                                                                                      
								var oPublishData = {                                                                                                                                                                                                                                   
									terrain: terrain,                                                                                                                                                                                                                                     
									allhighlightedTerrains: thiz.oHighlightedTerrains,                                                                                                                                                                                                    
									allfilledTerrains: thiz.oFilledTerrains,                                                                                                                                                                                                              
									isFill: isFill,                                                                                                                                                                                                                                       
									isBorder: isBorder,                                                                                                                                                                                                                                   
									oBorder: oBorder,                                                                                                                                                                                                                                     
									oFill: oFill                                                                                                                                                                                                                                          
								};                                                                                                                                                                                                                                                     
								thiz.hideLoading();                                                                                                                                                                                                                                    
								thiz.updateModel();                                                                                                                                                                                                                                    
								base.getEventBus().publish("map", "onClick", oPublishData); // call edit mode                                                                                                                                                                          
							})                                                                                                                                                                                                                                                      
						}, function (oError) {                                                                                                                                                                                                                                   
							thiz.hideLoading();                                                                                                                                                                                                                                     
						});                                                                                                                                                                                                                                                      
					});                                                                                                                                                                                                                                                       
			} // on select event                                                                                                                                                                                                                                        
		}, // init Map                                                                                                                                                                                                                                               
		updateModel : function(){                                                                                                                                                                                                                                    
			var thiz = this;                                                                                                                                                                                                                                            
			var data = {allhighlightedTerrains: thiz.oHighlightedTerrains, allfilledTerrains: thiz.oFilledTerrains}                                                                                                                                                     
			sap.ui.getCore().getModel("gis").setData(data);                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
		showLoading: function () {                                                                                                                                                                                                                                   
			esri.show(this.loading);                                                                                                                                                                                                                                    
			//this.map.disableMapNavigation();                                                                                                                                                                                                                          
			this.map.hideZoomSlider();                                                                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
		hideLoading: function (error) {                                                                                                                                                                                                                              
			esri.hide(this.loading);                                                                                                                                                                                                                                    
			//this.map.enableMapNavigation();                                                                                                                                                                                                                           
			this.map.showZoomSlider();                                                                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
		/** set terrain border color                                                                                                                                                                                                                                 
		 * @param {array} aTerrain -&nbsp;                                                                                                                                                                                                                           
		 * */                                                                                                                                                                                                                                                        
		setTerrainBorderColor: function (map, aTerrain1) {                                                                                                                                                                                                           
			var thiz = this;                                                                                                                                                                                                                                            
			if(!map){                                                                                                                                                                                                                                                   
				map = thiz.map;                                                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
			thiz.showLoading();                                                                                                                                                                                                                                         
			thiz.selTerrainGraphics.clear(); // clear all graphics for border layer                                                                                                                                                                                     
			aTerrain1.forEach(function (item) {                                                                                                                                                                                                                         
				thiz.oHighlightedTerrains[item.terrain] = item;                                                                                                                                                                                                            
			});                                                                                                                                                                                                                                                         
			var aTerrain = [];                                                                                                                                                                                                                                          
			for (var pro in thiz.oHighlightedTerrains) {                                                                                                                                                                                                                
				aTerrain.push(thiz.oHighlightedTerrains[pro]); // prepare data for draw border&nbsp;&nbsp;&nbsp;                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
			arcGis.require(["esri/tasks/query", "esri/graphic","esri/Color"], function (Query,                                                                                                                                                                          
				 Graphic, Color) {                                                                                                                                                                                                                                         
				if (aTerrain && aTerrain.length != 0) {                                                                                                                                                                                                                    
					var condition = "";                                                                                                                                                                                                                                       
					aTerrain.forEach(function(item){                                                                                                                                                                                                                          
						condition += "OR CODFAZTAL='" + item.terrain + "' "                                                                                                                                                                                                      
					});                                                                                                                                                                                                                                                       
					condition = condition.substring(2,condition.length);                                                                                                                                                                                                      
					var q = new Query();                                                                                                                                                                                                                                      
					q.returnGeometry = true;                                                                                                                                                                                                                                  
					q.outFields = ["*"];                                                                                                                                                                                                                                      
					q.outSpatialReference = {                                                                                                                                                                                                                                 
						"wkid": 4326                                                                                                                                                                                                                                             
					};                                                                                                                                                                                                                                                        
					q.where = condition;                                                                                                                                                                                                                                      
					thiz.queryTask.execute(q, resultQuery);                                                                                                                                                                                                                   
					function resultQuery(fset) {                                                                                                                                                                                                                              
						if (fset.features.length != 0) {                                                                                                                                                                                                                         
							var result = fset.features;                                                                                                                                                                                                                             
							for (var i = 0; i < result.length; i++) {                                                                                                                                                                                                               
								aTerrain.forEach(function (item) {                                                                                                                                                                                                                     
									if (item.terrain == result[i].attributes.CODFAZTAL) {                                                                                                                                                                                                 
										var esricol = new Color(item.color);                                                                                                                                                                                                                 
									}                                                                                                                                                                                                                                                     
									if (esricol) {                                                                                                                                                                                                                                        
										var symbol = new esri.symbol.SimpleLineSymbol().setColor(esricol);                                                                                                                                                                                   
										var graphic = new Graphic(result[i].geometry, symbol, {                                                                                                                                                                                              
											"Terrain": result[i].attributes.CODFAZTAL                                                                                                                                                                                                           
										});                                                                                                                                                                                                                                                  
										thiz.hideLoading();                                                                                                                                                                                                                                  
										thiz.selTerrainGraphics.add(graphic);                                                                                                                                                                                                                
										thiz.map.addLayer(thiz.selTerrainGraphics);                                                                                                                                                                                                          
									}                                                                                                                                                                                                                                                     
									thiz.oHighlightedTerrains[item.terrain] = item;                                                                                                                                                                                                       
								});                                                                                                                                                                                                                                                    
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
						thiz.updateModel();                                                                                                                                                                                                                                      
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		unSetTerrainBorderColor: function (map, aTerrain) {                                                                                                                                                                                                          
			var thiz = this;                                                                                                                                                                                                                                            
			if (aTerrain.length === 0) {                                                                                                                                                                                                                                
				return;                                                                                                                                                                                                                                                    
			} // if no data then return                                                                                                                                                                                                                                 
			if (!map) {                                                                                                                                                                                                                                                 
				map = this.map;                                                                                                                                                                                                                                            
			}&nbsp;                                                                                                                                                                                                                                                     
			aTerrain.forEach(function (item) {                                                                                                                                                                                                                          
				delete thiz.oHighlightedTerrains[item.terrain]; // delete selected terrain                                                                                                                                                                                 
			});                                                                                                                                                                                                                                                         
			var arr = [];                                                                                                                                                                                                                                               
			for (var pro in thiz.oHighlightedTerrains) {                                                                                                                                                                                                                
				arr.push(thiz.oHighlightedTerrains[pro]); // prepare data for draw border&nbsp;&nbsp;&nbsp;                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
			this.setTerrainBorderColor(map, arr); // draw border for previous terrains                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
		fillTerrains: function (map, terrWithColor) {                                                                                                                                                                                                                
			var thiz = this;                                                                                                                                                                                                                                            
			if (!map) {                                                                                                                                                                                                                                                 
				map = thiz.map;                                                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
			arcGis.require(["esri/tasks/query", "esri/graphic", "esri/Color"],                                                                                                                                                                                          
				function (Query, Graphic, Color) {                                                                                                                                                                                                                         
					if (terrWithColor && terrWithColor.length != 0) {                                                                                                                                                                                                         
						var condition = " ";                                                                                                                                                                                                                                     
						for (var i = 0; i < terrWithColor.length; i++) {                                                                                                                                                                                                         
							if (i === 0) {                                                                                                                                                                                                                                          
								condition += "CODFAZTAL='" + terrWithColor[i].terrain + "'"                                                                                                                                                                                            
							} else if (i === terrWithColor.length - 1) {                                                                                                                                                                                                            
								condition += " OR CODFAZTAL='" + terrWithColor[i].terrain + "'"                                                                                                                                                                                        
							} else {                                                                                                                                                                                                                                                
								condition += " OR CODFAZTAL='" + terrWithColor[i].terrain + "'"                                                                                                                                                                                        
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
						var q = new Query();                                                                                                                                                                                                                                     
						q.returnGeometry = true;                                                                                                                                                                                                                                 
						q.outFields = ["*"];                                                                                                                                                                                                                                     
						q.outSpatialReference = {                                                                                                                                                                                                                                
							"wkid": 4326                                                                                                                                                                                                                                            
						};                                                                                                                                                                                                                                                       
						q.where = condition;                                                                                                                                                                                                                                     
						thiz.queryTask.execute(q, resultQuery);                                                                                                                                                                                                                  
						function resultQuery(fset) {                                                                                                                                                                                                                             
							if (fset.features.length != 0) {                                                                                                                                                                                                                        
								var result = fset.features;                                                                                                                                                                                                                            
								for (var i = 0; i < result.length; i++) {                                                                                                                                                                                                              
									terrWithColor.forEach(function (item) {                                                                                                                                                                                                               
										if (item.terrain == result[i].attributes.CODFAZTAL) {                                                                                                                                                                                                
											var esricol = new Color(item.color);                                                                                                                                                                                                                
										}                                                                                                                                                                                                                                                    
										if (esricol) {                                                                                                                                                                                                                                       
											var symbol = new esri.symbol.SimpleFillSymbol().setColor(esricol);                                                                                                                                                                                  
											var graphic = new Graphic(result[i].geometry, symbol, {                                                                                                                                                                                             
												"Terrain": result[i].attributes.CODFAZTAL                                                                                                                                                                                                          
											});                                                                                                                                                                                                                                                 
											thiz.fillTerrainGraphics.add(graphic);                                                                                                                                                                                                              
											thiz.map.addLayer(thiz.fillTerrainGraphics);                                                                                                                                                                                                        
										}                                                                                                                                                                                                                                                    
										thiz.oFilledTerrains[item.terrain] = item;                                                                                                                                                                                                           
									});                                                                                                                                                                                                                                                   
								}                                                                                                                                                                                                                                                      
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
						thiz.updateModel();                                                                                                                                                                                                                                      
					}                                                                                                                                                                                                                                                         
				});                                                                                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
		clearFillTerrains: function (map, aTerrain) {                                                                                                                                                                                                                
			var thiz = this;                                                                                                                                                                                                                                            
			thiz.fillTerrainGraphics.clear(); // clear all graphics                                                                                                                                                                                                     
			aTerrain.forEach(function (item) {                                                                                                                                                                                                                          
				delete thiz.oFilledTerrains[item.terrain]; // delete all entries of selected fill terrains                                                                                                                                                                 
			});                                                                                                                                                                                                                                                         
			var arrFill = [];                                                                                                                                                                                                                                           
			for (var pro in thiz.oFilledTerrains) { // prepare data for remaining terrains                                                                                                                                                                              
				arrFill.push(thiz.oFilledTerrains[pro]);                                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
			this.fillTerrains(this.map, arrFill); // fill previous terrains&nbsp;                                                                                                                                                                                       
		},                                                                                                                                                                                                                                                           
		                                                                                                                                                                                                                                                             
		showFarm: function (farm) {                                                                                                                                                                                                                                  
			var thiz = this;                                                                                                                                                                                                                                            
			arcGis.require(["esri/tasks/query"], function (Query) {                                                                                                                                                                                                     
				var map = thiz.map;                                                                                                                                                                                                                                        
				var sq = new Query();                                                                                                                                                                                                                                      
				sq.outSpatialReference = {                                                                                                                                                                                                                                 
					"wkid": 4326                                                                                                                                                                                                                                              
				};                                                                                                                                                                                                                                                         
				sq.returnGeometry = true;                                                                                                                                                                                                                                  
				sq.outFields = ["*"];                                                                                                                                                                                                                                      
				sq.where = "COD_IMOVEL='" + farm + "'";                                                                                                                                                                                                                    
				thiz.queryTask.execute(sq, showResults1);                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
				function showResults1(results) {                                                                                                                                                                                                                           
					if (results.features.length !== 0) {                                                                                                                                                                                                                      
						//var teraingeometry = results.features[0].geometry;                                                                                                                                                                                                     
						//var resultCount = results.features.length;                                                                                                                                                                                                             
						var terainextent = results.features[0].geometry.getExtent().expand(4.0);                                                                                                                                                                                 
						var mSetting = terainextent;                                                                                                                                                                                                                             
						mSetting.xmin = mSetting.xmin;                                                                                                                                                                                                                           
						mSetting.ymin = mSetting.ymin;                                                                                                                                                                                                                           
						mSetting.xmax = mSetting.xmax;                                                                                                                                                                                                                           
						mSetting.ymax = mSetting.ymax;                                                                                                                                                                                                                           
						thiz.map.setExtent(mSetting);                                                                                                                                                                                                                            
						//var maxZoom = map.getMaxZoom();                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		getHighlightedTerrainByParam: function (obj) {                                                                                                                                                                                                               
			var oHigh = this.oHighlightedTerrains;                                                                                                                                                                                                                      
			var len = Object.keys(obj).length;                                                                                                                                                                                                                          
			var aSel = [];                                                                                                                                                                                                                                              
			for (var sTerr in oHigh) {                                                                                                                                                                                                                                  
				var oTObj = oHigh[sTerr];                                                                                                                                                                                                                                  
				var arr = [];                                                                                                                                                                                                                                              
				for (var pro in obj) {                                                                                                                                                                                                                                     
					if (oTObj.hasOwnProperty(pro)) {                                                                                                                                                                                                                          
						if (obj[pro] === oTObj[pro]) {                                                                                                                                                                                                                           
							arr.push(true);                                                                                                                                                                                                                                         
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				if (arr.length === len) {                                                                                                                                                                                                                                  
					aSel.push(oTObj);                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			var oTerrains = {};                                                                                                                                                                                                                                         
			var aTerrains = aSel.map(function (item) {                                                                                                                                                                                                                  
				oTerrains[item.terrain] = item;                                                                                                                                                                                                                            
				return item.terrain;                                                                                                                                                                                                                                       
			});                                                                                                                                                                                                                                                         
			return {                                                                                                                                                                                                                                                    
				aSelObj: aSel,                                                                                                                                                                                                                                             
				terrains: aTerrains,                                                                                                                                                                                                                                       
				oTerrains: oTerrains                                                                                                                                                                                                                                       
			};                                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
		clearGraphics: function (map) {                                                                                                                                                                                                                              
			this.oHighlightedTerrains = {};                                                                                                                                                                                                                             
			this.oFilledTerrains = {};                                                                                                                                                                                                                                  
			this.selTerrainGraphics.clear();                                                                                                                                                                                                                            
			this.fillTerrainGraphics.clear();                                                                                                                                                                                                                           
		}                                                                                                                                                                                                                                                            
	}; // main object return                                                                                                                                                                                                                                      
});                                                                                                                                                                                                                                                            